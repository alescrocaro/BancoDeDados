DROP TABLE IF EXISTS PEDIDO_CONTEM_PIZZA;
DROP TABLE IF EXISTS PIZZA_TAMANHO;
DROP TABLE IF EXISTS PIZZA;
DROP TABLE IF EXISTS TAMANHO;
DROP TABLE IF EXISTS PEDIDO;
DROP TABLE IF EXISTS CLIENTE;
DROP TABLE IF EXISTS BAIRRO;
DROP TABLE IF EXISTS ATENDENTE;
DROP TABLE IF EXISTS ENTREGADOR;
DROP TABLE IF EXISTS FUNCIONARIO;

CREATE TABLE PIZZA(
 num INTEGER,
 nome VARCHAR(500),
 ingredientes VARCHAR(1000),
 PRIMARY KEY(num)
);

CREATE TABLE TAMANHO(
  descricao VARCHAR(100),
  PRIMARY KEY(descricao)
);

CREATE TABLE PIZZA_TAMANHO(
   num INTEGER,
   descricao VARCHAR(100),
   preco DECIMAL(10,2),
   PRIMARY KEY(num, descricao),
   FOREIGN KEY(num) REFERENCES PIZZA(num),
   FOREIGN KEY(descricao) REFERENCES TAMANHO(descricao)
);

CREATE TABLE BAIRRO(
   nome VARCHAR(300),
   tempo TIME,
   PRIMARY KEY(nome)
);

CREATE TABLE CLIENTE(
   nome VARCHAR(300),
   tel CHAR(9),
   bairro VARCHAR(300),
   PRIMARY KEY(tel),
   FOREIGN KEY(bairro) REFERENCES BAIRRO(nome)
);

CREATE TABLE FUNCIONARIO(
   id INTEGER,
   PRIMARY KEY(id)
);

CREATE TABLE ATENDENTE(
   id INTEGER,
   PRIMARY KEY(id),
   FOREIGN KEY(id) REFERENCES FUNCIONARIO(id) ON DELETE CASCADE
);

CREATE TABLE ENTREGADOR(
   id INTEGER,
   tel CHAR(9),
   PRIMARY KEY(id),
   FOREIGN KEY(id) REFERENCES FUNCIONARIO(id) ON DELETE CASCADE
);

CREATE TABLE PEDIDO(
   num INTEGER,
   data DATE,
   endereco VARCHAR(300),
   tel CHAR(9),
   id_entregador INTEGER,
   id_atendente INTEGER,
   PRIMARY KEY(num),
   FOREIGN KEY(tel) REFERENCES CLIENTE(tel),
   FOREIGN KEY(id_entregador) REFERENCES ENTREGADOR(id),
   FOREIGN KEY(id_atendente) REFERENCES ATENDENTE(id)
);

CREATE TABLE PEDIDO_CONTEM_PIZZA(
   descricao VARCHAR(100),
   num_pizza INTEGER,
   num_pedido INTEGER,
   PRIMARY KEY(descricao, num_pizza, num_pedido),
   FOREIGN KEY(descricao, num_pizza) REFERENCES PIZZA_TAMANHO(descricao, num),
   FOREIGN KEY(num_pedido) REFERENCES PEDIDO(num)
);